<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Beställningsformulär - IFK Lidingö Bordtennis</title>
  <style>
    /* ---------------------------------------
       1) Grundläggande layout, resets & responsiv
    --------------------------------------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background-color: #001F3F;
      color: #fff;
      line-height: 1.4;
    }
    .container {
      display: flex;
      gap: 10px;
      min-height: 100vh;
      justify-content: center;
      align-items: flex-start;
      padding: 10px;
    }
    .left-col, .right-col {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      position: sticky;
      top: 60px;
      align-self: flex-start;
      max-height: calc(100vh - 80px);
      overflow-y: auto;
      background: linear-gradient(#00264D, #001F3F);
      border-radius: 8px;
      padding: 15px;
    }
    .center-col {
      flex: 3;
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        align-items: center;
      }
      .left-col, .right-col {
        position: static;
        max-height: none;
        overflow: visible;
        width: 100%;
        margin-bottom: 20px;
        background: none;
        padding: 0;
      }
      .center-col {
        width: 100%;
        margin-bottom: 20px;
      }
    }

    /* ---------------------------------------
       2) Kupongruta och kategoriboxar
    --------------------------------------- */
    .promo-coupon {
      background-color: #00264D;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      width: 260px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .promo-coupon p {
      margin: 0;
      color: #fff;
      font-size: 1.1rem;
    }
    .promo-coupon strong {
      font-weight: bold;
      color: #ffd700;
    }
    .category-box {
      background-color: #00264D;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      width: 260px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .category-box img {
      width: 100%;
      border-radius: 8px;
    }
    .category-box p {
      margin: 8px 0 0;
      color: #fff;
      font-size: 1.1rem;
    }
    .category-box:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.4);
    }

    /* ---------------------------------------
       3) Formulär, rubriker, produkt-sektioner
    --------------------------------------- */
    form {
      background-color: #fff;
      color: #333;
      padding: 20px;
      border-radius: 12px;
      max-width: 800px;
      width: 100%;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      position: relative;
    }
    form h2 {
      margin-top: 0;
      color: #333;
    }
    form h3 {
      margin: 20px 0 10px;
      color: #333;
      font-size: 1.2rem;
    }
    label {
      display: block;
      font-weight: bold;
      margin-top: 10px;
      color: #333;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    input[type="number"] {
      max-width: 100px;
    }
    .product {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
      background: #f9f9f9;
    }
    .product img {
      max-width: 120px;
      display: block;
      margin-bottom: 10px;
    }
    .product p {
      margin-top: 0;
    }

    /* Totalsummering */
    .total-container {
      background: #eef;
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
      font-weight: bold;
      color: #333;
    }
    .total-container small {
      display: block;
      margin-top: 5px;
      color: #999;
      font-weight: normal;
      font-size: 0.9rem;
    }

    /* ---------------------------------------
       4) Förhandsvisning (#livePreview)
    --------------------------------------- */
    .preview-box {
      background: #eef;
      padding: 10px;
      border-radius: 4px;
      color: #333;
      margin: 20px 0;
    }
    .preview-box h4 {
      margin-bottom: 10px;
      color: #333;
    }
    .preview-box table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
    }
    .preview-box th, .preview-box td {
      border: 1px solid #ccc;
      padding: 6px;
      font-size: 0.9rem;
      text-align: left;
    }

    /* Skicka-knapp */
    input[type="submit"] {
      background-color: #007bff;
      color: #fff;
      border: none;
      cursor: pointer;
      padding: 15px;
      font-size: 1rem;
      border-radius: 6px;
      margin-top: 10px;
    }
    input[type="submit"]:hover {
      background-color: #0056b3;
    }

    /* Tack-overlay */
    .thank-you-overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0, 0, 0, 0.8);
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 20px;
      border-radius: 8px;
      z-index: 999;
      display: none;
    }
    .thank-you-overlay h2 {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

<div class="container">

  <!-- VÄNSTER KOLUMN -->
  <div class="left-col">
    <!-- Kupongruta -->
    <div class="promo-coupon">
      <p>Era medlemmar har <strong>15% rabatt</strong><br/>
         på Yasakatabletennis.com<br/>
         med koden <strong>lidingo15</strong></p>
    </div>

    <!-- Kategoriboxar -->
    <div class="category-box">
      <a href="https://yasakatabletennis.com/product-category/blades" target="_blank">
        <img src="https://bunny-wp-pullzone-2n5sdzke4o.b-cdn.net/wp-content/uploads/2024/09/header-blade.jpg"
             alt="Yasaka Blades" />
        <p>Se Blades</p>
      </a>
    </div>
    <div class="category-box">
      <a href="https://yasakatabletennis.com/product-category/rubbers" target="_blank">
        <img src="https://bunny-wp-pullzone-2n5sdzke4o.b-cdn.net/wp-content/uploads/2024/09/header-rubbers.jpg"
             alt="Yasaka Rubbers" />
        <p>Se Rubbers</p>
      </a>
    </div>
    <div class="category-box">
      <a href="https://yasakatabletennis.com/product-category/apparel" target="_blank">
        <img src="https://bunny-wp-pullzone-2n5sdzke4o.b-cdn.net/wp-content/uploads/2024/09/apparel-category.jpg"
             alt="Yasaka Apparel" />
        <p>Se Apparel</p>
      </a>
    </div>
    <div class="category-box">
      <a href="https://yasakatabletennis.com/products/" target="_blank">
        <img src="https://bunny-wp-pullzone-2n5sdzke4o.b-cdn.net/wp-content/uploads/2024/09/all-products.jpg"
             alt="Alla produkter" />
        <p>Alla Produkter</p>
      </a>
    </div>
  </div>

  <!-- MITT-KOLUMN: FORMULÄRET -->
  <div class="center-col">
    <form action="https://formspree.io/f/xoveqpdr" method="POST" onsubmit="handleSubmit(event)">
      
      <!-- (1) Ange _format=html för att försöka skicka HTML till Formspree -->
      <input type="hidden" name="_format" value="html" />

      <!-- (2) Dolda fält: Subjekt, reply-to, orderinfo -->
      <input type="hidden" name="_subject" value="Ny beställning - IFK Lidingö Bordtennis" />
      <input type="hidden" name="_replyto" id="replyToField" value="" />
      <input type="hidden" name="Beställning" id="order_summary" />

      <h2>Kunduppgifter</h2>
      <label for="namn">För- och efternamn:</label>
      <input type="text" id="namn" name="namn" required placeholder="Ex: Andersson" />

      <label for="adress">Leveransadress:</label>
      <textarea id="adress" name="adress" rows="2" required></textarea>

      <label for="mobilnummer">Mobilnummer:</label>
      <input type="tel" id="mobilnummer" name="mobilnummer" required placeholder="Ex: 0701234567" />

      <label for="mejl">Mejladress:</label>
      <input type="email" id="mejl" name="mejl" required placeholder="Ex: andersson@gmail.com" />

      <!-- T-shirt-sektion -->
      <h3>Tröjor</h3>

      <!-- T-shirt #1 -->
      <div class="product">
        <img 
          src="https://www.donic.com/thumbnail/b1/ce/7e/1713786743/donic-t-shirt-drop-navy_1920x1920.jpg"
          alt="T-shirt #1" />
        <p>
          <strong>Donic T-shirt Drop Navy #1</strong><br/>
          Pris/st: <span id="tshirt_pris1">525</span> kr<br/>
          Namntryck: +100 kr
        </p>
        <label for="tshirt_size1">Storlek</label>
        <select id="tshirt_size1">
          <option value="">(Ingen)</option>
          <!-- <option value="XS" data-article="S82440234-XS">XS</option> etc. -->
        </select>
        <label for="tshirt_qty1">Antal</label>
        <input type="number" id="tshirt_qty1" min="0" value="0" />
        <label for="tshirt_namntryck1">Namntryck</label>
        <input type="text" id="tshirt_namntryck1" placeholder="Ex: Andersson" />
      </div>

      <!-- T-shirt #2 (Liknande uppsättning, men <span id="tshirt_pris2"> ) -->

      <!-- Shorts-sektion -->
      <h3>Shorts</h3>
      <!-- Shorts #1, #2, med short_pris1, short_pris2 -->

      <!-- Overalls-sektion -->
      <h3>Overalls</h3>
      <!-- Overall #1, #2, med overall_pris1, overall_pris2 -->

      <!-- Totalsummering -->
      <div class="total-container">
        <div id="totalDisplay">Totalt: 0 kr</div>
        <small>*Fraktkostnad tillkommer</small>
      </div>

      <!-- (3) Förhandsvisning (#livePreview) -->
      <div class="preview-box" id="livePreview">
        <h4>Förhandsvisning</h4>
        <p>Än så länge ingen beställning gjord.</p>
      </div>

      <input type="submit" value="Skicka Beställning" />

      <!-- Tack-overlay -->
      <div class="thank-you-overlay" id="thankYouOverlay">
        <h2>Tack för din beställning!</h2>
        <p>
          Vi har mottagit din order och hanterar den snarast.<br/>
          Du får ingen automatisk bekräftelse i gratisversionen,<br/>
          men vi återkommer via mejl för att bekräfta.<br/>
          Tack för ditt tålamod!
        </p>
      </div>
    </form>
  </div>

  <!-- HÖGER KOLUMN -->
  <div class="right-col">
    <div class="promo-coupon">
      <p>Era medlemmar har <strong>15% rabatt</strong><br/>
         på Yasakatabletennis.com<br/>
         med koden <strong>lidingo15</strong></p>
    </div>

    <div class="category-box">
      <a href="https://yasakatabletennis.com/product-category/blades" target="_blank">
        <img 
          src="https://bunny-wp-pullzone-2n5sdzke4o.b-cdn.net/wp-content/uploads/2024/09/header-blade.jpg"
          alt="Blades" />
        <p>Se Blades</p>
      </a>
    </div>
    <!-- ... (Rubbers, Apparel, etc) ... -->
  </div>

</div>

<script>
  /* Samma hämtnings- och beräkningslogik, men nu skriver vi HTML-tabell i “buildSummary()”
     samt uppdaterar #livePreview i “updatePreview()” */
  
  function getPrice(id) {
    return parseFloat(document.getElementById(id).textContent.trim());
  }
  function nameTryckExtraCost(nameFieldId) {
    const val = document.getElementById(nameFieldId).value.trim();
    return (val !== '') ? 100 : 0;
  }
  function getSelectedArticle(selectId) {
    const sel = document.getElementById(selectId);
    if (!sel) return '(Inget select)';
    const idx = sel.selectedIndex;
    if (idx === -1) return '(Ingen)';
    const opt = sel.options[idx];
    return opt.getAttribute('data-article') || '(Ingen)';
  }

  function calculateTotal() {
    // T-shirt #1
    let tshirtPrice1 = getPrice('tshirt_pris1');
    let tshirtQty1   = parseInt(document.getElementById('tshirt_qty1').value) || 0;
    let tshirtNamn1  = nameTryckExtraCost('tshirt_namntryck1');

    // T-shirt #2
    let tshirtPrice2 = getPrice('tshirt_pris2');
    let tshirtQty2   = parseInt(document.getElementById('tshirt_qty2').value) || 0;
    let tshirtNamn2  = nameTryckExtraCost('tshirt_namntryck2');

    // Shorts #1
    let shortsPrice1 = getPrice('shorts_pris1');
    let shortsQty1   = parseInt(document.getElementById('shorts_qty1').value) || 0;

    // Shorts #2
    let shortsPrice2 = getPrice('shorts_pris2');
    let shortsQty2   = parseInt(document.getElementById('shorts_qty2').value) || 0;

    // Overalls #1
    let overallPrice1 = getPrice('overall_pris1');
    let overallQty1   = parseInt(document.getElementById('overall_qty1').value) || 0;
    let overallNamn1  = nameTryckExtraCost('overall_namntryck1');

    // Overalls #2
    let overallPrice2 = getPrice('overall_pris2');
    let overallQty2   = parseInt(document.getElementById('overall_qty2').value) || 0;
    let overallNamn2  = nameTryckExtraCost('overall_namntryck2');

    let total =
       (tshirtPrice1 * tshirtQty1 + tshirtNamn1 * tshirtQty1)
     + (tshirtPrice2 * tshirtQty2 + tshirtNamn2 * tshirtQty2)
     + (shortsPrice1 * shortsQty1)
     + (shortsPrice2 * shortsQty2)
     + (overallPrice1 * overallQty1 + overallNamn1 * overallQty1)
     + (overallPrice2 * overallQty2 + overallNamn2 * overallQty2);

    document.getElementById('totalDisplay').textContent = `Totalt: ${total} kr`;
    return total;
  }

  /* (3) Bygga en livePreview-tabell */
  function updatePreview() {
    let previewDiv = document.getElementById('livePreview');

    // Hämta relevant data
    let tshirtSize1 = document.getElementById('tshirt_size1').value || '(Ingen)';
    let tshirtArt1  = getSelectedArticle('tshirt_size1');
    let tshirtQty1  = document.getElementById('tshirt_qty1').value || '0';
    let tshirtNtryck1 = document.getElementById('tshirt_namntryck1').value.trim();

    // ... upprepa för T-shirt #2, Shorts #1 & #2, Overalls ...
    // Här visar jag bara T-shirt #1 som exempel, du fyller på alla rader du vill.

    let total = calculateTotal(); 

    let htmlPreview = `
      <h4>Förhandsvisning</h4>
      <table>
        <tr>
          <th>Produkt</th><th>Artikelnr</th><th>Storlek</th><th>Antal</th><th>Namntryck</th>
        </tr>
        <tr>
          <td>T-shirt #1</td>
          <td>${tshirtArt1}</td>
          <td>${tshirtSize1}</td>
          <td>${tshirtQty1}</td>
          <td>${tshirtNtryck1 ? tshirtNtryck1 : 'Inget'}</td>
        </tr>
        <!-- Fyll på T-shirt #2, Shorts #1, Shorts #2, Overalls #1, Overalls #2... -->
      </table>
      <p><strong>Totalt just nu:</strong> ${total} kr</p>
    `;

    previewDiv.innerHTML = htmlPreview;
  }

  function buildSummary() {
    let total = calculateTotal();

    // Hämta kundinfo
    let kundNamn   = document.getElementById('namn').value;
    let kundAdress = document.getElementById('adress').value;
    let kundMobil  = document.getElementById('mobilnummer').value;
    let kundMejl   = document.getElementById('mejl').value;

    // Hämta T-shirt #1 info
    let tshirtSize1 = document.getElementById('tshirt_size1').value || '(Ingen)';
    let tshirtArt1  = getSelectedArticle('tshirt_size1');
    let tshirtQty1  = document.getElementById('tshirt_qty1').value || '0';
    let tshirtNtryck1 = document.getElementById('tshirt_namntryck1').value.trim();

    // ... hämta T-shirt #2, Shorts #1, Shorts #2, Overalls #1, Overalls #2 ...

    // Bygger en HTML-tabell för mejlet
    let htmlSummary = `
    <h2>Kunduppgifter</h2>
    <p><strong>Namn:</strong> ${kundNamn}<br/>
       <strong>Adress:</strong> ${kundAdress}<br/>
       <strong>Mobil:</strong> ${kundMobil}<br/>
       <strong>Mejl:</strong> ${kundMejl}</p>

    <table border="1" cellpadding="5" style="border-collapse:collapse;">
      <tr>
        <th>Produkt</th>
        <th>Artikelnr</th>
        <th>Storlek</th>
        <th>Antal</th>
        <th>Namntryck</th>
      </tr>
      <tr>
        <td>T-shirt #1</td>
        <td>${tshirtArt1}</td>
        <td>${tshirtSize1}</td>
        <td>${tshirtQty1}</td>
        <td>${tshirtNtryck1 ? tshirtNtryck1 : 'Inget'}</td>
      </tr>
      <!-- Fyll på T-shirt #2, Shorts #1, Shorts #2, Overalls #1, Overalls #2 -->
    </table>

    <p><strong>Totalt beräknat pris:</strong> ${total} kr<br/>
    <em>(Fraktkostnad tillkommer)</em></p>
    `;

    // Lägg i dold input => Formspree skickar HTML
    document.getElementById('order_summary').value = htmlSummary;

    // Sätt “replyToField” => ni kan svara direkt i mailklienten
    document.getElementById('replyToField').value = kundMejl;
  }

  function showThankYou() {
    document.getElementById('thankYouOverlay').style.display = 'flex';
  }

  function handleSubmit(e) {
    buildSummary();
    showThankYou();
  }

  // Koppla event-listeners
  const fieldsToWatch = [
    'tshirt_qty1','tshirt_qty2','tshirt_namntryck1','tshirt_namntryck2',
    'shorts_qty1','shorts_qty2',
    'overall_qty1','overall_qty2','overall_namntryck1','overall_namntryck2'
  ];
  fieldsToWatch.forEach(id => {
    const el = document.getElementById(id);
    if (el) {
      el.addEventListener('input', () => {
        calculateTotal();
        updatePreview();   // uppdaterar “livePreview” hela tiden
      });
    }
  });

  // Initiera total + preview en gång
  calculateTotal();
  updatePreview();
</script>

</body>
</html>
